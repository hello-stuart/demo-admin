import{m as S,p as f,q as B}from"./chunk-6542H3SY.js";import{aa as d,c as p,ed as x,f as i,fa as y,g as v,hd as m,t as l,z as b}from"./chunk-CKWEI2SK.js";var O=class h{constructor(e,n,t,a){this.backendService=e;this.toastr=n;this.indexedDBService=t;this.http=a}expireTime;value;AllSportsStatic;AllSports=new i;isActiveHome=new i;CurrentSportObj=new i;Marquee_hide=new i;ods=new i;activesportSubject=new i;EventId=new i;expoModal=new i;betlist=new i;routeUrlForSideNav=new i;showHideStreaming=new v(null);setCompttiondata=new i;sportsList=new v(null);isCalledAfterBetplaceFun=new v(!1);isSatusCloseBetslip=new v(!1);odds=new i;exposureDesktopbetSlip=new i;afterBetPL=new i;betPlace=new i;forClass=new i;betsData=new i;setIplayget=new i;tabsportId=new i;gotoMarket=new i;balanceExpo=new i;LoggedIn=new i;hitmatchBets=new i;setcompttion(e){this.setCompttiondata.next(e)}getcompttion(){return this.setCompttiondata.asObservable()}getStreamingStatus(){return this.showHideStreaming}setStreamingStatus(e){this.showHideStreaming.next(e)}set_Marquee_Value(e){this.Marquee_hide.next(e)}get_Marquee_Value(){return this.Marquee_hide.asObservable()}setsportId(e){this.activesportSubject.next(e)}getsportId(){return this.activesportSubject.asObservable()}setOds(e){this.ods.next(e)}getOds(){return this.ods.asObservable()}setIsActiveHome(e){this.isActiveHome.next(e),this.CurrentSportObj=e}getIsActiveHome(){return this.isActiveHome.asObservable()}getDataFromServices(e,n,t){return new p(a=>{t||(t={});let r=e.split("/").filter(Boolean).pop();this.indexedDBService.getRecord(r+"Time").subscribe(s=>{if(s){let o=new Date(s),u=new Date().getTime()-o.getTime();Math.floor(u/(1e3*60))>n?this.getRecordsFromNetwork(e,t).subscribe(c=>{a.next(c),a.complete()},c=>{a.error(c)}):this.getRecordsFromDB(e,t).subscribe(c=>{a.next(c),a.complete()},c=>{a.error(c)})}else this.getRecordsFromNetwork(e,t).subscribe(o=>{a.next(o),a.complete()},o=>{a.error(o)})})})}setEventId(e){this.EventId=e}getEventID(){return this.EventId}getStaticSports(){return this.AllSportsStatic}getAllSports(){return this.AllSports.asObservable()}setAllSports(e){this.AllSportsStatic=e,this.AllSports.next(e)}createtimestamp(e){return this.indexedDBService.createRecord(e,Date())}getRecordsFromNetwork(e,n){return new p(t=>{let a=e.split("/").filter(Boolean).pop();this.backendService.getAllRecordsByPost(e,n).subscribe(r=>{this.indexedDBService.createRecord(a,r).subscribe(()=>{this.createtimestamp(a+"Time").subscribe(()=>{t.next(r),t.complete()},s=>{t.error(s)})},s=>{t.error(s)})},r=>{t.error(r)})})}getRecordsFromDB(e,n){return new p(t=>{let a=e.split("/").filter(Boolean).pop();this.indexedDBService.getRecord(a).subscribe(r=>{r?(t.next(r),t.complete()):this.getRecordsFromNetwork(e,n).subscribe(s=>{t.next(s),t.complete()},s=>{t.error(s)})},r=>{console.error("Error retrieving record: ",r),t.error(r)})})}tipsAndPreviewManager(e){let n={},t=this.casinoImgsManager(e.preview,"","preview").pipe(l(r=>(n.preview=r,r))),a=this.casinoImgsManager(e.tips,"","tips").pipe(l(r=>(n.tips=r,r)));return b([t,a]).pipe(l(()=>n))}casinoImgsManager(e,n,t){let a=e.map(r=>p.create(s=>{this.convertImageUrlToBase64(r.url?r.url:r).then(o=>{r.url?r.url=o==""?r.url:o:r=o==""?r.url:o,s.next(r),s.complete()}).catch(o=>{s.error(o)})}));return b(a).pipe(l(r=>r.reduce((o,g)=>{let u=t;return o[u]||(o[u]=[]),o[u].push(g),o},{})))}convertImageUrlToBase64(e){return fetch(e).then(n=>{if(!n.ok)throw new Error(`Error fetching image: ${n.status} ${n.statusText}`);return n.blob()}).then(n=>new Promise((t,a)=>{let r=new FileReader;r.onloadend=()=>t(r.result),r.onerror=()=>t(""),r.readAsDataURL(n)})).catch(n=>(console.error("Error converting image to Base64:",n),""))}ImageToBase64Manager(e){let n=Object.keys(e).map(t=>{let a=e[t];return p.create(r=>{this.convertImageUrlToBase64(a).then(s=>{e[t]=s,r.next({key:t,value:s}),r.complete()}).catch(s=>{r.error(s)})})});return b(n).pipe(l(t=>e))}ImageToBase64ThemeConfigManager(e){let n=Object.keys(e).map(t=>{let a=e[t];return p.create(r=>{t.includes("exchangeFavicon")||t.includes("exchangeLogo")?this.convertImageUrlToBase64(a).then(s=>{e[t]=s,r.next({key:t,value:s}),r.complete()}).catch(s=>{r.error(s)}):(r.next({key:t,value:e[t]}),r.complete())})});return b(n).pipe(l(t=>e))}getUserBetList(){return this.http.post(m.getUserBetList,{})}userAccountStatement(){return this.http.post(m.userAccountStatement,{})}AddFavourites(e){let n=new Date;return this.indexedDBService.getRecord("favourites").pipe(l(t=>{if(t){let a=t.findIndex(r=>r?.exMarketId===e?.exMarketId&&r?.exEventId===e?.exEventId);a!==-1?(t.splice(a,1),this.indexedDBService.updateRecord("favourites",t).subscribe(r=>{})):(e.expireTime=n,t.push(e),this.indexedDBService.updateRecord("favourites",t).subscribe(r=>{}))}else{e.expireTime=n;let a=[e];this.indexedDBService.createRecord("favourites",a).subscribe(r=>{})}return t}))}getFavourites(){return this.indexedDBService.getRecord("favourites").pipe(l(e=>{let n=new Date;return e=e?.filter(t=>{let a=new Date(t.expireTime),r=n.getTime()-a.getTime(),s=Math.floor(r/(1e3*60))}),this.indexedDBService.updateRecord("favourites",e).subscribe(t=>{}),e}))}seteposureModal(e){this.expoModal.next(e)}geteposureModal(){return this.expoModal.asObservable()}setbetlist(e){this.betlist.next(e)}getbetlist(){return this.betlist.asObservable()}getSportsList(){return this.sportsList}setSportsList(e){this.sportsList.next(e)}setIplay(e){this.setIplayget.next(e)}getIplay(){return this.setIplayget.asObservable()}setgotoMarket(e){this.gotoMarket.next(e)}getgotoMarket(){return this.gotoMarket.asObservable()}setBalanceExpo(e){this.balanceExpo.next(e)}getBalanceExpo(){return this.balanceExpo.asObservable()}getLoggedIn(){return this.LoggedIn.asObservable()}setLoggedIn(e){this.LoggedIn.next(e)}getCalledAfterBetplaceFun(){return this.isCalledAfterBetplaceFun}setCalledAfterBetplaceFun(e){this.isCalledAfterBetplaceFun.next(e)}getSatusCloseBetslip(){return this.isSatusCloseBetslip}setStatusCloseBetslip(e){this.isSatusCloseBetslip.next(e)}getOdds(){return this.odds.asObservable()}setExposureProfit(e){this.exposureDesktopbetSlip.next(e)}setAfterBetPL(e){this.afterBetPL.next(e)}setForbetPlace(e){this.betPlace.next(e)}setForClass(e){this.forClass.next(e)}getBetsData(){return this.betsData.asObservable()}setMatchbets(e){this.hitmatchBets.next(e)}getAllRecordsByPost(e,n){return this.http.post(e,n).pipe(l(t=>t))}ErrorNotification_Manager(e){if(e.meta){let t=e.meta.message;if(typeof t=="object")for(var n of Object.keys(t)){this.toastr.error(t[n].message,"",{});return}else{this.toastr.error(t,"",{});return}}else{this.toastr.error("Hey, looks like something went wrong.","",{});return}}static \u0275fac=function(n){return new(n||h)(y(B),y(S),y(f),y(x))};static \u0275prov=d({token:h,factory:h.\u0275fac,providedIn:"root"})};export{O as a};
