import{a as N}from"./chunk-YAPTLMR7.js";import{a as D}from"./chunk-AZX2OHK4.js";import{a as M}from"./chunk-SBFAXTSC.js";import{c as P,d as B}from"./chunk-A5YAUSYP.js";import{a as E}from"./chunk-3J6HDLJO.js";import"./chunk-KMJAJAAH.js";import"./chunk-QZIUMNBJ.js";import{m as O,q as R}from"./chunk-6542H3SY.js";import{f as w}from"./chunk-F4ECYANF.js";import{Db as m,Nb as r,O as A,Ob as i,Pb as d,Tc as S,Uc as _,Wb as b,_a as v,bb as s,cb as c,dc as o,ec as l,gc as f,hd as x,mb as I,mc as k,sb as h,tc as p,uc as u}from"./chunk-CKWEI2SK.js";import"./chunk-ZR4K4ZIC.js";var W=a=>[a];function F(a,e){if(a&1&&(r(0,"div",16),d(1,"img",17),i()),a&2){let t=e.$implicit;s(),m("src",k(1,W,"../../../assets/cards/"+t+".png"),v)}}function L(a,e){if(a&1&&(r(0,"div",16),d(1,"img",18),i()),a&2){let t=e.$implicit;s(),m("src",k(1,W,"../../../assets/cards/"+t+".png"),v)}}function z(a,e){if(a&1&&(r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"b",5),o(5),i(),r(6,"span",6),o(7),i()(),r(8,"div",7)(9,"div",8)(10,"div",9),h(11,F,2,3,"div",10),i()(),r(12,"div",11)(13,"span",12),o(14,"0"),i(),r(15,"span"),o(16),p(17,"shortNumber"),p(18,"shortNumber"),i()()()(),d(19,"div",13),r(20,"div",14)(21,"div",4)(22,"b",5),o(23),i(),r(24,"span",6),o(25),i()(),r(26,"div",7)(27,"div",8)(28,"div",9),h(29,L,2,3,"div",10),i()(),r(30,"div",11)(31,"span",12),o(32,"0"),i(),r(33,"span"),o(34),p(35,"shortNumber"),p(36,"shortNumber"),i()()()()(),r(37,"div",15),d(38,"app-resultbar"),i()()),a&2){let t=b();s(5),l(t.capitalize(t.marketArray[0]==null?null:t.marketArray[0].runnersName[t.marketArray[0]==null||t.marketArray[0].runners[0]==null?null:t.marketArray[0].runners[0].selectionId])),s(2),l(t.marketArray[0]==null||t.marketArray[0].runners[0]==null||t.marketArray[0].runners[0].price==null||t.marketArray[0].runners[0].price.back[0]==null?null:t.marketArray[0].runners[0].price.back[0].price),s(4),m("ngForOf",t.LOW),s(5),f(" ",u(17,10,t.winnerMarketArray==null?null:t.winnerMarketArray.min)," - ",u(18,12,t.winnerMarketArray==null?null:t.winnerMarketArray.max)," "),s(7),l(t.capitalize(t.marketArray[0]==null?null:t.marketArray[0].runnersName[t.marketArray[0]==null||t.marketArray[0].runners[1]==null?null:t.marketArray[0].runners[1].selectionId])),s(2),l(t.marketArray[0]==null||t.marketArray[0].runners[1]==null||t.marketArray[0].runners[1].price==null||t.marketArray[0].runners[1].price.back[0]==null?null:t.marketArray[0].runners[1].price.back[0].price),s(4),m("ngForOf",t.HIGH),s(5),f(" ",u(35,14,t.winnerMarketArray==null?null:t.winnerMarketArray.min)," - ",u(36,16,t.winnerMarketArray==null?null:t.winnerMarketArray.max)," ")}}var T=class a{constructor(e,t,n,g,y,C){this.route=e;this.toaster=t;this.casinoService=n;this.backendService=g;this.encyDecy=y;this.conditionhandlerService=C;this.eventid=this.route.snapshot.params.id,this._roomId="",this.message.id=this.eventid}subscription;subscription2;message={type:"1",id:""};_roomId;LOW;HIGH;game;timer;eventid;marketId;split_arr;gameroundId;marketArray;RoundWinner;playerACards;selectedCell;playerBCards;winningAmount;changeValue;luckyMarketArray;winnerMarketArray;currentRunnerPrice;runnersName={};getRoundId="";eventName;counter=0;theme;resultcounter=0;ngOnInit(){this.route.params.subscribe(e=>{let t=e.id}),this.encyDecy.generateEncryptionKey("",this.message),this.subscription=this.encyDecy.getMarketData().subscribe((e=[])=>{if(e){this.getRoundId=localStorage.getItem("roundID");let t=JSON.parse(e);Array.isArray(t.data)?t?.data[0]&&(t.type=="1"&&(this.marketArray=t?.data[0]?.marketArr,this.game=t?.data[0],this.game.marketArr=this.marketArray?this.marketArray:t?.data[0]?.marketArr,this.eventName=t?.data[0]?.eventName,this.winnerMarketArray=this.game?.marketArr?this.game?.marketArr[0]:""),this.handleEventResponse(t,0)):this.handleEventResponse(t,0),this.game&&(this.winnerMarketArray=this.game?.marketArr?this.game?.marketArr[0]:"",this.luckyMarketArray=this.game?.marketArr?this.game?.marketArr[4]:"",this.marketArray=this.game.marketArr,this.gameroundId=this.game.roundId,this.game.eventName=this.eventName?this.eventName:this.game.eventName,this.backendService.updateRoundId(this.game),(this.getRoundId!=this.game.roundId||this.getRoundId=="")&&(localStorage.setItem("roundID",this.game.roundId),this.getBalance(),this.getResults(),this.selectedCell=""),this.playerACards=this.game?.cardsArr?.PLAYER_A,this.playerBCards=this.game?.cardsArr?.PLAYER_B,this.winnerMarketArray=this.game.marketArr?this.game.marketArr[0]:"",this.luckyMarketArray=this.game.marketArr?this.game.marketArr[4]:"",this.runnersName=this.winnerMarketArray.runnersName,this.marketArray=this.game.marketArr)}}),this.getResults()}handleEventResponse(e,t){if(Array.isArray(e))e.forEach(n=>{this.marketObhManager(n)});else{let n=e;this.marketObhManager(n);return}}marketObhManager(e){if(e&&e.type=="1")if("data"in e&&this.counter==0&&e.data.marketArr&&e.data._id)this.marketArray=e.data.marketArr,this.game=this.marketArray?this.marketArray:e.data,this.game=e.data,this.eventName=e.data.eventName,this.counter=1;else{if("marketArr"in e?.data&&Array.isArray(e.data.marketArr)&&(this.game.marketArr=e?.data?.marketArr),"cardsArr"in e?.data&&(Array.isArray(e?.data?.cardsArr)||(this.game.cardsArr=e?.data?.cardsArr,this.HIGH=this.game?.cardsArr?.HIGH,this.LOW=this.game?.cardsArr?.LOW)),"roundId"in e&&(this.game.roundId=e?.roundId),"roundId"in e?.data&&(this.game.roundId=e?.data?.roundId),"status"in e?.data&&(this.game.status=e?.data?.status),"cardCount"in e?.data&&(this.game.cardCount=e?.data?.cardCount),"resultsArr"in e?.data){for(let n in e?.data?.resultsArr[0]?.runners)e.data?.resultsArr[0]?.runners[n]=="WINNER"&&(this.RoundWinner=e?.data?.resultsArr[0]?.runnersName[n],this.backendService.setResultData(this.RoundWinner)),e.data?.resultsArr[0]?.runners[n]=="WINNER"&&setTimeout(()=>{this.backendService.setResultWinningAmount(this.winningAmount),this.backendService.setResultSparkData(!0)},1e3);setTimeout(()=>{this.RoundWinner=null,this.winningAmount=null,this.backendService.setResultData(this.RoundWinner),this.backendService.setResultWinningAmount(this.winningAmount)},5e3)}var t=Object.keys(e?.data)[0];if(t.includes(".")){this.split_arr=t.split("."),Object.entries(e.data).forEach(([,C])=>this.changeValue=C);let n=parseInt(this.split_arr[1]),g=this.split_arr[3],y=this.split_arr[6];this.split_arr[7]=="size"&&(this.marketArray[n].runners[g].price.back[y].size=this.changeValue),this.split_arr[7]=="price"&&(this.marketArray[n].runners[g].price.back[y].price=this.changeValue)}}}getEventOdds(){this.backendService.getCasinoEventOdds(this.eventid).subscribe(e=>{e.meta.status_code==200?(this.game=e?.data,this.marketArray=this.game?.marketArr,this.playerACards=this.game?.cardsArr?.PLAYER_A,this.playerBCards=this.game?.cardsArr?.PLAYER_B,this.winnerMarketArray=this.game?.marketArr?this.game?.marketArr[0]:"",this.luckyMarketArray=this.game?.marketArr?this.game?.marketArr[4]:"",this.runnersName=this.winnerMarketArray.runnersName):this.toaster.error(e.meta.message,"",{positionClass:"toast-top-right"})})}trackByFn(e,t){return e}ngAfterViewInit(){}getResults(){this.backendService.getAllRecordsByPost(x.getCasinoResultURL,{eventId:this.eventid}).pipe(A()).subscribe(e=>{this.backendService.updateResultstream(e.data)},e=>{let t=e})}ngOnDestroy(){let e={type:"2",id:""};this.encyDecy.sendMessageToSocket(e),this.subscription&&this.subscription.unsubscribe(),this.subscription2&&this.subscription2.unsubscribe()}getBalance(){this.backendService.getAllRecordsByPost(x.getUserBalanceURL,{}).pipe(A()).subscribe(e=>{if(e.meta.status==!0){let t=(e.data.bankBalance-e.data.exposure).toFixed(2);$(".userTotalBalance").text(t),$(".userTotalExposure").text(e.data.exposure)}},e=>{let t=e})}capitalize(e){return e?e.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()):""}static \u0275fac=function(t){return new(t||a)(c(w),c(O),c(D),c(R),c(B),c(E))};static \u0275cmp=I({type:a,selectors:[["app-casino-metter"]],decls:3,vars:1,consts:[["class","casino-detail",4,"ngIf"],[1,"casino-detail"],[1,"casino-container"],[1,"casino-left"],[1,"text-center"],[1,"player"],[1,"text-success"],[1,"w-100"],[1,"casino-cards","text-center","mt-1"],[1,"casino-card-item"],["class","card-image",4,"ngFor","ngForOf"],[1,"casino-min-max"],[1,"book-black"],[1,"casino-center"],[1,"casino-right"],[1,"showInMobile"],[1,"card-image"],[1,"",3,"src"],[3,"src"]],template:function(t,n){t&1&&(r(0,"div"),d(1,"app-video-player"),i(),h(2,z,39,18,"div",0)),t&2&&(s(2),m("ngIf",(n.marketArray==null?null:n.marketArray.length)>0))},dependencies:[M,_,S,N,P],styles:[".casino-detail[_ngcontent-%COMP%]{padding:10px;box-shadow:none;border-radius:0;background-color:#f8f8fb;line-height:22px;letter-spacing:0;color:#000;font-family:Noto Sans;font-size:14px}.casino-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;width:100%}.casino-left[_ngcontent-%COMP%]{width:100%;margin-bottom:10px;padding:2px 10px;background-color:#ddd;cursor:pointer;border-radius:8px}.casino-center[_ngcontent-%COMP%]{width:2px;background-color:gray;display:none}.casino-right[_ngcontent-%COMP%]{width:100%;margin-bottom:10px;padding:2px 10px;cursor:pointer;border-radius:8px;background-color:#ddd}.player[_ngcontent-%COMP%]{color:#ef910f;font-weight:700}.text-success[_ngcontent-%COMP%]{color:#128412!important;margin-left:.5rem}.casino-cards[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;align-items:flex-start;width:100%}.casino-card-item[_ngcontent-%COMP%]{margin-bottom:0;min-width:45px!important;margin-right:5px;margin-left:5px;width:auto;display:flex;flex-wrap:wrap;column-gap:30px;justify-content:center}.card-image[_ngcontent-%COMP%]{cursor:pointer;display:inline-block}.card-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:40px!important;height:56px;margin-bottom:10px}.casino-min-max[_ngcontent-%COMP%]{font-size:9px;color:#000;display:flex;align-items:center;justify-content:space-between}@media screen and (min-width: 768px){.card-image[_ngcontent-%COMP%]{width:35px!important;height:49px!important}.book-black[_ngcontent-%COMP%]{font-size:18px;line-height:18px}.casino-center[_ngcontent-%COMP%]{display:block}.casino-left[_ngcontent-%COMP%], .casino-right[_ngcontent-%COMP%]{width:49%;background-color:#ddd;padding:10px;cursor:pointer;border-radius:8px;margin-bottom:0}}"]})};export{T as CasinoMetterComponent};
