import{a as P}from"./chunk-YAPTLMR7.js";import{a as D}from"./chunk-AZX2OHK4.js";import{a as E}from"./chunk-PW5J7ZGW.js";import{c as N,d as M}from"./chunk-3BRWB67J.js";import"./chunk-5UJXZMZS.js";import"./chunk-ACVM4ET5.js";import"./chunk-QZIUMNBJ.js";import{m as S,q as R}from"./chunk-TKUFSEQW.js";import{f as w}from"./chunk-F4ECYANF.js";import{Db as c,Nb as a,O as f,Ob as o,Pb as h,Sc as k,Tc as _,Uc as I,Wb as g,_c as O,bb as i,cb as l,dc as m,ec as u,fc as b,hd as v,mb as x,nc as C,sb as p,tc as y,uc as A}from"./chunk-CKWEI2SK.js";import"./chunk-ZR4K4ZIC.js";var T=(n,e)=>({"border-red":n,"border-yellow":e});function W(n,e){n&1&&h(0,"img",15)}function z(n,e){n&1&&h(0,"img",16)}function L(n,e){if(n&1&&(a(0,"div",6)(1,"div",7),m(2," Min: "),a(3,"span"),m(4),y(5,"shortNumber"),o(),m(6," Max: "),a(7,"span"),m(8),y(9,"shortNumber"),o()(),a(10,"div",8)(11,"button",9),p(12,W,1,0,"img",10),a(13,"span",11),m(14),o(),p(15,z,1,0,"img",12),o()(),a(16,"div",13)(17,"b",14),m(18),o()()()),n&2){let t=e.$implicit,r=e.index,d=g().$implicit,s=g();i(4),u(A(5,8,d==null?null:d.min)),i(4),u(A(9,10,d==null?null:d.max)),i(2),c("ngClass",s.winnerMarketArray.runners[0].status=="SUSPEND"||s.game.status=="SUSPEND"?"suspended":s.selectedCell==s.winnerMarketArray.runners[0].selectionId?"selected":""),i(),c("ngClass",C(12,T,r%2==0,r%2!=0)),i(),c("ngIf",r%2!=0),i(2),b(" ",s.winnerMarketArray.runnersName[t.selectionId]," "),i(),c("ngIf",r%2==0),i(3),u(t.price.back[0]==null?null:t.price.back[0].price)}}function H(n,e){if(n&1&&(a(0,"div",4),p(1,L,19,15,"div",5),o()),n&2){let t=g();i(),c("ngForOf",t.winnerMarketArray==null?null:t.winnerMarketArray.runners)}}var B=class n{constructor(e,t,r,d,s){this.route=e;this.toaster=t;this.casinoService=r;this.backendService=d;this.encyDecy=s;this.eventid=this.route.snapshot.params.id,this._roomId="",this.message.id=this.eventid}subscription;subscription2;message={type:"1",id:""};_roomId;LOW;HIGH;game;timer;eventid;marketId;split_arr;gameroundId;marketArray;RoundWinner;playerACards;selectedCell;playerBCards;winningAmount;changeValue;luckyMarketArray;winnerMarketArray;currentRunnerPrice;runnersName={};getRoundId="";eventName;counter=0;theme;resultcounter=0;ngOnInit(){this.route.params.subscribe(e=>{let t=e.id}),this.encyDecy.generateEncryptionKey("",this.message),this.subscription=this.encyDecy.getMarketData().subscribe((e=[])=>{if(e){this.getRoundId=localStorage.getItem("roundID");let t=JSON.parse(e);Array.isArray(t.data)?t?.data[0]&&(t.type=="1"&&(this.marketArray=t?.data[0]?.marketArr,this.game=t?.data[0],this.game.marketArr=this.marketArray?this.marketArray:t?.data[0]?.marketArr,this.eventName=t?.data[0]?.eventName,this.winnerMarketArray=this.game?.marketArr?this.game?.marketArr[0]:""),this.handleEventResponse(t,0)):this.handleEventResponse(t,0),this.game&&(this.winnerMarketArray=this.game?.marketArr?this.game?.marketArr[0]:"",this.luckyMarketArray=this.game?.marketArr?this.game?.marketArr[4]:"",this.marketArray=this.game.marketArr,this.gameroundId=this.game.roundId,this.game.eventName=this.eventName?this.eventName:this.game.eventName,this.backendService.updateRoundId(this.game),(this.getRoundId!=this.game.roundId||this.getRoundId=="")&&(localStorage.setItem("roundID",this.game.roundId),this.getBalance(),this.getResults(),this.selectedCell=""),this.playerACards=this.game?.cardsArr?.PLAYER_A,this.playerBCards=this.game?.cardsArr?.PLAYER_B,this.winnerMarketArray=this.game.marketArr?this.game.marketArr[0]:"",this.luckyMarketArray=this.game.marketArr?this.game.marketArr[4]:"",this.runnersName=this.winnerMarketArray.runnersName,this.marketArray=this.game.marketArr)}}),this.getResults()}handleEventResponse(e,t){if(Array.isArray(e))e.forEach(r=>{this.marketObhManager(r)});else{let r=e;this.marketObhManager(r);return}}marketObhManager(e){if(e&&e.type=="1")if("data"in e&&this.counter==0&&e.data.marketArr&&e.data._id)this.marketArray=e.data.marketArr,this.game=this.marketArray?this.marketArray:e.data,this.game=e.data,this.eventName=e.data.eventName,this.counter=1;else{if("marketArr"in e?.data&&Array.isArray(e.data.marketArr)&&(this.game.marketArr=e?.data?.marketArr),"cardsArr"in e?.data&&(Array.isArray(e?.data?.cardsArr)||(this.game.cardsArr=e?.data?.cardsArr,this.HIGH=this.game?.cardsArr?.HIGH,this.LOW=this.game?.cardsArr?.LOW)),"roundId"in e&&(this.game.roundId=e?.roundId),"roundId"in e?.data&&(this.game.roundId=e?.data?.roundId),"status"in e?.data&&(this.game.status=e?.data?.status),"cardCount"in e?.data&&(this.game.cardCount=e?.data?.cardCount),"resultsArr"in e?.data){for(let r in e?.data?.resultsArr[0]?.runners)e.data?.resultsArr[0]?.runners[r]=="WINNER"&&(this.RoundWinner=e?.data?.resultsArr[0]?.runnersName[r],this.backendService.setResultData(this.RoundWinner)),e.data?.resultsArr[0]?.runners[r]=="WINNER"&&setTimeout(()=>{this.backendService.setResultWinningAmount(this.winningAmount),this.backendService.setResultSparkData(!0)},1e3);setTimeout(()=>{this.RoundWinner=null,this.winningAmount=null,this.backendService.setResultData(this.RoundWinner),this.backendService.setResultWinningAmount(this.winningAmount)},5e3)}var t=Object.keys(e?.data)[0];if(t.includes(".")){this.split_arr=t.split("."),Object.entries(e.data).forEach(([,F])=>this.changeValue=F);let r=parseInt(this.split_arr[1]),d=this.split_arr[3],s=this.split_arr[6];this.split_arr[7]=="size"&&(this.marketArray[r].runners[d].price.back[s].size=this.changeValue),this.split_arr[7]=="price"&&(this.marketArray[r].runners[d].price.back[s].price=this.changeValue)}}}getEventOdds(){this.backendService.getCasinoEventOdds(this.eventid).subscribe(e=>{e.meta.status_code==200?(this.game=e?.data,this.marketArray=this.game?.marketArr,this.playerACards=this.game?.cardsArr?.PLAYER_A,this.playerBCards=this.game?.cardsArr?.PLAYER_B,this.winnerMarketArray=this.game?.marketArr?this.game?.marketArr[0]:"",this.luckyMarketArray=this.game?.marketArr?this.game?.marketArr[4]:"",this.runnersName=this.winnerMarketArray.runnersName):this.toaster.error(e.meta.message,"",{positionClass:"toast-top-right"})})}trackByFn(e,t){return e}ngAfterViewInit(){}getResults(){this.backendService.getAllRecordsByPost(v.getCasinoResultURL,{eventId:this.eventid}).pipe(f()).subscribe(e=>{this.backendService.updateResultstream(e.data)},e=>{let t=e})}ngOnDestroy(){let e={type:"2",id:""};this.encyDecy.sendMessageToSocket(e),this.subscription&&this.subscription.unsubscribe(),this.subscription2&&this.subscription2.unsubscribe()}getBalance(){this.backendService.getAllRecordsByPost(v.getUserBalanceURL,{}).pipe(f()).subscribe(e=>{if(e.meta.status==!0){let t=(e.data.bankBalance-e.data.exposure).toFixed(2);$(".userTotalBalance").text(t),$(".userTotalExposure").text(e.data.exposure)}},e=>{let t=e})}capitalize(e){return e?e.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()):""}static \u0275fac=function(t){return new(t||n)(l(w),l(S),l(D),l(R),l(M))};static \u0275cmp=x({type:n,selectors:[["app-one-card-meter"]],decls:6,vars:1,consts:[[1,"videoPlayer"],[1,"cm-table","font-noto-sans"],["class","d-flex flex-wrap justify-content-between",4,"ngFor","ngForOf"],[1,"showInMobile"],[1,"d-flex","flex-wrap","justify-content-between"],["class","meter-btn",4,"ngFor","ngForOf"],[1,"meter-btn"],[1,"text-end","min-max"],[1,"w-100","position-relative",3,"ngClass"],[1,"btn","btn-fighter-1","w-100","position-relative","d-flex","justify-content-center","align-items-center","text-uppercase","text-center","fw-bold",3,"ngClass"],["src","assets/card-meter/fight.png","alt","Fight","class","fighter-2 w-auto",4,"ngIf"],[1,"f-text"],["src","assets/card-meter/fight.png","alt","Fight","class","fighter-1 w-auto",4,"ngIf"],[1,"book-green","text-center","fw-bold"],[1,"book-black"],["src","assets/card-meter/fight.png","alt","Fight",1,"fighter-2","w-auto"],["src","assets/card-meter/fight.png","alt","Fight",1,"fighter-1","w-auto"]],template:function(t,r){t&1&&(a(0,"div",0),h(1,"app-video-player"),o(),a(2,"div",1),p(3,H,2,1,"div",2),a(4,"div",3),h(5,"app-resultbar"),o()()),t&2&&(i(3),c("ngForOf",r.marketArray))},dependencies:[E,P,O,k,_,I,N],styles:['.cm-table[_ngcontent-%COMP%]{padding:30px 5px;background-color:#f8f8fb;border-radius:0 0 8px 8px;box-shadow:0 2px 6px #e2e2e2}.meter-btn[_ngcontent-%COMP%]{width:48%}.min-max[_ngcontent-%COMP%], .min-max[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;color:#000;letter-spacing:-.04rem}.btn-fighter-1[_ngcontent-%COMP%], .btn-fighter-2[_ngcontent-%COMP%]{height:70px;font-size:24px!important;line-height:49px;border-radius:0;z-index:1}.btn-fighter-1[_ngcontent-%COMP%]:after, .btn-fighter-2[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:0;width:100%;height:100%;border-radius:0;background-color:#72bbef;z-index:-2}.border-red[_ngcontent-%COMP%]:after{border:3px solid #e22739;box-shadow:0 0 6px #c8c8c8}.border-yellow[_ngcontent-%COMP%]:after{border:3px solid #ecc116;box-shadow:0 0 6px #c8c8c8}.btn[_ngcontent-%COMP%]{color:#495057;vertical-align:middle;cursor:pointer;-webkit-user-select:none;user-select:none;border:1px solid transparent;padding:.47rem .75rem;line-height:1.5}.f-text[_ngcontent-%COMP%]{letter-spacing:-.05rem}.fighter-1[_ngcontent-%COMP%]{transform:rotate(90deg);height:40px;margin-left:10px}.fighter-2[_ngcontent-%COMP%]{transform:rotate(270deg);height:40px;margin-right:10px}.book-green[_ngcontent-%COMP%]{color:#128412;font-size:14px}@media only screen and (max-width: 767px){.meter-btn[_ngcontent-%COMP%]{margin-bottom:21px;width:100%}.fighter-1[_ngcontent-%COMP%]{transform:rotate(180deg)}.fighter-2[_ngcontent-%COMP%]{transform:rotate(0)}.book-green[_ngcontent-%COMP%]{font-size:11px;line-height:22px}}@media only screen and (min-width: 320px) and (max-width: 1279px){.cm-table[_ngcontent-%COMP%]{padding:30px 5px;box-shadow:none;border-radius:0}}.suspended[_ngcontent-%COMP%]:after{content:"";background-color:#737574d6;z-index:50;position:absolute;height:100%;width:100%;left:0;top:0;cursor:not-allowed;border-radius:3px;display:flex;justify-content:center;align-items:center}']})};export{B as OneCardMeterComponent};
